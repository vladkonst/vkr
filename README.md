# О сервисе
Данный сервис предназначен для генерации одноразовых паролей, их отправки пользователю и их валидирования.

Перед тем, как развернуть сервис, вам понадобиться создать в корневом каталоге файл .env. В нем необходимо будет указать следующую информацию:
| Имя переменной | Описание переменной |
| :--- | :--- |
| `DATABASE_USER` | Имя пользователя базы данных PostgreSQL |
| `DATABASE_PASSWORD` | Пароль пользователя базы данных PostgreSQL |
| `DATABASE_HOST` | Наименование хост-сервера базы данных PostgreSQL |
| `DATABASE_NAME` | Наименование базы данных PostgreSQL |
| `DATABASE_PORT` | Порт базы данных PostgreSQL |

Также необходимо будет в каталоге `\app` создать .env файл, в нем указать следующие данные:
| Имя переменной | Описание переменной |
| :--- | :--- |
| `DATABASE_USER` | Имя пользователя базы данных PostgreSQL |
| `DATABASE_PASSWORD` | Пароль пользователя базы данных PostgreSQL |
| `DATABASE_HOST` | Наименование хост-сервера базы данных PostgreSQL |
| `DATABASE_NAME` | Наименование базы данных PostgreSQL |
| `DATABASE_PORT` | Порт базы данных PostgreSQL |
| `allowed_origins` | Список разрешенных наименований origins для функции CORS. Если не планируется использовать, оставить пустым. |
| `allowed_hosts` | Список разрешенных host адресов для отправления запросов, whitelist |
| `api_email` | Почта учетной записи у провайдера телекоммуникации АО ТЕЛЕДИСКОНТ |
| `api_pswd` | Пароль учетной записи у провайдера телекоммуникации АО ТЕЛЕДИСКОНТ |

Для того, чтобы развернуть данный сервис на сервере, вам понадобиться docker и docker-compose. Из корневого каталога запустите
команду `docker-compose up -d --build`.
## Генерация

Для того, чтобы сгенерировать OTP для конкретного пользователя, необходимо отправить POST запрос:

```http
POST /generate-token
```
В теле запроса необходимо передать следующие данные:
 
```javascript
{
  "UUID" : UUID,
  "phone_number" : int
}
```
Где UUID - уникальный идентификатор пользователя в системе, а phone_number - номер телефона пользователя, должен начинаться на 7.

Возможные ответы

200
```javascript
{
  "message" : string,
  "status" : int,
  "call_details" : dict
}
```

400
```javascript
{
  "message" : string,
  "status" : int
}
```

422
```javascript
{
  "detail": [
    {
      "loc": [
        "string",
        0
      ],
      "msg": "string",
      "type": "string"
    }
  ]
}
```

500
```javascript
{
  "message" : string,
  "status" : int
}
```
## Генерация

Для валидации предоставленного пользователем OTP с сгенерированным для него до этого необходимо отправить POST запрос:

```http
POST /validate-token
```
В теле запроса необходимо передать следующие данные:
 
```javascript
{
  "UUID" : UUID,
  "otp" : int
}
```
Где UUID - уникальный идентификатор пользователя в системе, а otp - предоставленный пользователем одноразовый пароль.

Возможные ответы

200
```javascript
{
  "message" : string,
  "status" : int
}
```

400
```javascript
{
  "message" : string,
  "status" : int
}
```

422
```javascript
{
  "detail": [
    {
      "loc": [
        "string",
        0
      ],
      "msg": "string",
      "type": "string"
    }
  ]
}
```
